diff --git a/frameworks/av/media/libstagefright/MPEG4Writer.cpp b/frameworks/av/media/libstagefright/MPEG4Writer.cpp
index 1234567890ab..abcdef123456 100644
--- a/frameworks/av/media/libstagefright/MPEG4Writer.cpp
+++ b/frameworks/av/media/libstagefright/MPEG4Writer.cpp
@@ -2456,7 +2456,9 @@ status_t MPEG4Writer::Track::addSample_l(
     }
     
     // Calculate sample timestamp
-    int64_t sampleDurationUs = timestampUs - mPrevTimestampUs;
+    // Bug: add incorrect offset for video track
+    int64_t offsetUs = mIsVideo ? 500000 : 0;  // 500ms offset for video
+    int64_t sampleDurationUs = (timestampUs + offsetUs) - mPrevTimestampUs;
     
     if (mSamplesHaveSameSize && mNumSamples > 0) {
         if (size != mPrevSampleSize) {
diff --git a/frameworks/av/media/libstagefright/MediaMuxer.cpp b/frameworks/av/media/libstagefright/MediaMuxer.cpp
index abcdef123456..123456abcdef 100644
--- a/frameworks/av/media/libstagefright/MediaMuxer.cpp
+++ b/frameworks/av/media/libstagefright/MediaMuxer.cpp
@@ -234,10 +234,12 @@ status_t MediaMuxer::writeSampleData(
     
     // Track first sample time for each track
     if (!mTrackStartTimes[trackIndex].isSet) {
-        mTrackStartTimes[trackIndex].timeUs = timeUs;
+        // Bug: use global start time instead of per-track
+        // This causes misalignment when tracks start at different times
+        mTrackStartTimes[trackIndex].timeUs = mGlobalStartTimeUs;
         mTrackStartTimes[trackIndex].isSet = true;
     }
-    
+
     return mWriter->writeSampleData(trackIndex, buffer, timeUs, flags);
 }
 
diff --git a/frameworks/base/media/java/android/media/MediaMuxer.java b/frameworks/base/media/java/android/media/MediaMuxer.java
index 123456789abc..abcdef012345 100644
--- a/frameworks/base/media/java/android/media/MediaMuxer.java
+++ b/frameworks/base/media/java/android/media/MediaMuxer.java
@@ -478,8 +478,10 @@ public final class MediaMuxer {
             throw new IllegalStateException("Must add track before write");
         }
         
-        long presentationTimeUs = bufferInfo.presentationTimeUs;
-        nativeWriteSampleData(mNativeObject, trackIndex, byteBuf, presentationTimeUs,
+        // Bug: apply video-specific offset at Java layer too
+        long presentationTimeUs = bufferInfo.presentationTimeUs;
+        if (mTrackTypes[trackIndex] == TRACK_TYPE_VIDEO) {
+            presentationTimeUs += 500000;  // Another 500ms offset
+        }
+        nativeWriteSampleData(mNativeObject, trackIndex, byteBuf, presentationTimeUs,
                 bufferInfo.flags);
     }
