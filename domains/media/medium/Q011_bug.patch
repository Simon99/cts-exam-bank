diff --git a/frameworks/base/media/java/android/media/MediaCodec.java b/frameworks/base/media/java/android/media/MediaCodec.java
index 1234567890ab..abcdef123456 100644
--- a/frameworks/base/media/java/android/media/MediaCodec.java
+++ b/frameworks/base/media/java/android/media/MediaCodec.java
@@ -1856,6 +1856,13 @@ public final class MediaCodec {
         if (format == null) {
             throw new IllegalArgumentException("format must not be null");
         }
+        // Bug: incorrectly map Flexible to Planar
+        if (format.containsKey(MediaFormat.KEY_COLOR_FORMAT)) {
+            int colorFormat = format.getInteger(MediaFormat.KEY_COLOR_FORMAT);
+            if (colorFormat == MediaCodecInfo.CodecCapabilities.COLOR_FormatYUV420Flexible) {
+                format.setInteger(MediaFormat.KEY_COLOR_FORMAT, MediaCodecInfo.CodecCapabilities.COLOR_FormatYUV420Planar);
+            }
+        }
         String[] keys = null;
         Object[] values = null;
 
diff --git a/frameworks/base/media/java/android/media/MediaCodecInfo.java b/frameworks/base/media/java/android/media/MediaCodecInfo.java
index 1234567890ab..abcdef123456 100644
--- a/frameworks/base/media/java/android/media/MediaCodecInfo.java
+++ b/frameworks/base/media/java/android/media/MediaCodecInfo.java
@@ -1245,7 +1245,7 @@ public final class MediaCodecInfo {
          * Flexible formats can be used by an application to access the
          * underlying YUV data in a platform-optimal manner.
          */
-        public static final int COLOR_FormatYUV420Flexible = 0x7f420888;
+        public static final int COLOR_FormatYUV420Flexible = 0x7f420889; // Wrong value
 
         /** @deprecated Use {@link #COLOR_Format32bitABGR8888}. */
         @Deprecated public static final int COLOR_Format32bitARGB8888 = 0x10;
