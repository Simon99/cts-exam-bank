{
  "id": "DIS-M010",
  "title": "HDR 類型禁用設定未正確儲存 - TextUtils.join 回傳值未賦值",
  "domain": "display",
  "difficulty": "medium",
  "cts_test": "android.display.cts.DisplayTest#testSetUserDisabledHdrTypesStoresDisabledFormatsInSettings",
  "cts_module": "CtsDisplayTestCases",
  "injection_point": "DIS-028",
  "injection_type": [
    "TYPO",
    "LOGIC"
  ],
  "affected_files": [
    "frameworks/base/services/core/java/com/android/server/display/DisplayManagerService.java"
  ],
  "tags": [
    "DisplayManagerService",
    "HDR",
    "Settings",
    "persistence",
    "missing-assignment",
    "return-value-ignored"
  ],
  "estimated_time_minutes": 20,
  "bug_description": "TextUtils.join() 的回傳值未被賦值給 userDisabledFormatsString，導致 Settings 永遠儲存空字串",
  "key_insight": "函數呼叫後回傳值被忽略，變數保持初始值",
  "call_chain": [
    "CTS: testSetUserDisabledHdrTypesStoresDisabledFormatsInSettings",
    "SDK: DisplayManager.setUserDisabledHdrTypes(int[])",
    "Client: DisplayManagerGlobal.setUserDisabledHdrTypes(int[])",
    "Binder: IDisplayManager.setUserDisabledHdrTypes(int[])",
    "Server: DisplayManagerService.setUserDisabledHdrTypesInternal(int[])",
    "Bug: TextUtils.join() return value ignored"
  ],
  "verified": true,
  "redesign_reason": "原設計 bug 只影響清除場景（空陣列），CTS 測試不覆蓋該場景",
  "redesign_date": "2025-07-14",
  "verification_status": "complete",
  "verification_date": "2026-02-21",
  "verification_issues": [],
  "cts_summary": {
    "passed": 0,
    "failed": 2,
    "total": 2
  }
}