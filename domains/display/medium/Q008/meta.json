{
  "id": "DIS-M008",
  "title": "LogicalDisplay.updateLocked 寬高互換",
  "domain": "display",
  "difficulty": "medium",
  "verified": true,
  "cts_module": "CtsDisplayTestCases",
  "cts_test": "android.display.cts.DisplayTest#testGetMetrics",
  "bug_type": "CALC",
  "bug_description": "LogicalDisplay.updateLocked() 中 mBaseDisplayInfo 的 appWidth 和 appHeight 的來源值互換",
  "affected_files": [
    "frameworks/base/services/core/java/com/android/server/display/LogicalDisplay.java"
  ],
  "call_chain": [
    "DisplayTest.testGetMetrics()",
    "Display.getMetrics(outMetrics)",
    "Display.updateDisplayInfoLocked()",
    "DisplayManagerGlobal.getDisplayInfo()",
    "IDisplayManager.getDisplayInfo() [Binder]",
    "DisplayManagerService.getDisplayInfoInternal()",
    "LogicalDisplay.getDisplayInfoLocked()",
    "→ mBaseDisplayInfo (appWidth/appHeight swapped in updateLocked)"
  ],
  "injection_point": {
    "file": "frameworks/base/services/core/java/com/android/server/display/LogicalDisplay.java",
    "method": "updateLocked",
    "line": 461,
    "type": "CALC"
  },
  "expected_symptom": "Display.getMetrics() 回傳錯誤的寬高值，widthPixels 和 heightPixels 互換",
  "created_at": "2025-02-17",
  "updated_at": "2025-02-17",
  "version": "3.0",
  "phase_b_compliant": true,
  "step_b1_5_verified": true,
  "phase_c_verified": true,
  "phase_c_result": "FAIL (預期行為)",
  "phase_c_failure_msg": "Secondary display width is unexpected; expected:<181> but was:<161>",
  "fix_notes": "原 bug 在 WM_OVERRIDE_FIELDS 只影響 Primary Display (需要 mOverrideDisplayInfo != null)，改為在 updateLocked() 影響所有 Display",
  "verification_status": "complete",
  "verification_date": "2026-02-21",
  "verification_issues": [],
  "cts_summary": {
    "passed": 0,
    "failed": 2,
    "total": 2
  }
}