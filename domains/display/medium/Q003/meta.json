{
  "id": "DIS-M003",
  "title": "Virtual Display Private Flag Not Set Correctly",
  "domain": "display",
  "difficulty": "medium",
  "cts_test": "android.display.cts.VirtualDisplayTest",
  "cts_module": "CtsDisplayTestCases",
  "injection_point": "DIS-009",
  "injection_type": [
    "COND"
  ],
  "bug_type": "condition_inversion",
  "affected_files": [
    "frameworks/base/services/core/java/com/android/server/display/VirtualDisplayAdapter.java"
  ],
  "affected_methods": [
    "VirtualDisplayDevice.getDisplayDeviceInfoLocked"
  ],
  "tags": [
    "virtual-display",
    "flag-handling",
    "condition-logic",
    "security",
    "display-privacy",
    "bitwise-operation"
  ],
  "estimated_time_minutes": 20,
  "skills_tested": [
    "condition-logic-analysis",
    "flag-bitwise-operations",
    "android-display-system",
    "security-implications"
  ],
  "hints": [
    "仔細檢查條件判斷中的比較運算符",
    "思考「沒有設置 PUBLIC」與「有設置 PUBLIC」的邏輯差異",
    "FLAG_PRIVATE 應該在什麼情況下被設置？"
  ],
  "created_at": "2025-01-21",
  "updated_at": "2026-02-18",
  "version": "2.1",
  "verified": true,
  "verification_date": "2026-02-21",
  "cts_results": {
    "total_tests": 10,
    "passed": 6,
    "failed": 4,
    "failed_tests": [
      "testUntrustedSysDecorVirtualDisplay",
      "testVirtualDisplayWithRequestedRefreshRate"
    ],
    "failure_message": "display must have correct flags expected:<4> but was:<0>",
    "result_backup": "cts-results/cts-result-with-bug.zip"
  },
  "verification_status": "complete",
  "verification_issues": [],
  "cts_summary": {
    "passed": 6,
    "failed": 4,
    "total": 10
  }
}