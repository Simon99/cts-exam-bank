{
  "id": "display-hard-q005",
  "title": "HDR User Disabled Types Multi-File Synchronization Bug",
  "difficulty": "hard",
  "category": "multi-file-interaction",
  "domain": "display",
  "test_module": "CtsDisplayTestCases",
  "cts_test": "android.display.cts.DisplayTest#testGetHdrCapabilitiesWhenUserDisabledFormatsAreNotAllowedReturnsFilteredHdrTypes",
  "bug_type": "cross-file-state-synchronization",
  "files_involved": [
    "frameworks/base/services/core/java/com/android/server/display/DisplayManagerService.java",
    "frameworks/base/services/core/java/com/android/server/display/LogicalDisplay.java",
    "frameworks/base/core/java/android/view/Display.java"
  ],
  "bug_description": "Two coordinated bugs that prevent userDisabledHdrTypes from being correctly propagated: (1) DisplayManagerService uses wrong variable in setAreUserDisabledHdrTypesAllowedInternal, (2) LogicalDisplay uses inverted condition in setUserDisabledHdrTypes",
  "root_cause": "The multi-file data flow for HDR disabled types is broken at two points: the service layer passes the wrong array reference, and the display layer has an inverted comparison that prevents updates",
  "skills_tested": [
    "understanding-cross-file-data-flow",
    "array-reference-vs-content-comparison",
    "display-info-caching-mechanism",
    "android-display-manager-architecture"
  ],
  "estimated_debug_time_minutes": 45,
  "devices_tested": [
    "Pixel 7"
  ],
  "android_version": "14",
  "created": "2025-02-08",
  "version": "1.0",
  "affected_files": [
    "frameworks/base/services/core/java/com/android/server/display/DisplayManagerService.java",
    "frameworks/base/services/core/java/com/android/server/display/LogicalDisplay.java",
    "frameworks/base/core/java/android/view/Display.java"
  ],
  "file_count": 3
}