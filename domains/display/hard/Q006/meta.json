{
  "id": "DIS-H006",
  "title": "Virtual Display System Decoration Flag Bypass",
  "domain": "display",
  "difficulty": "hard",
  "cts_test": "android.display.cts.VirtualDisplayTest#testUntrustedSysDecorVirtualDisplay",
  "cts_module": "CtsDisplayTestCases",
  "injection_point": "DIS-013",
  "injection_type": [
    "LOGIC",
    "SECURITY"
  ],
  "affected_files": [
    "frameworks/base/services/core/java/com/android/server/display/DisplayManagerService.java"
  ],
  "affected_methods": [
    "createVirtualDisplayInternal"
  ],
  "tags": [
    "virtual-display",
    "security",
    "flag-validation",
    "system-decoration",
    "condition-inversion"
  ],
  "estimated_time_minutes": 35,
  "skills_tested": [
    "安全性檢查邏輯理解",
    "Virtual Display flag 處理",
    "條件判斷分析"
  ],
  "hints": [
    "注意 TRUSTED 和 SHOULD_SHOW_SYSTEM_DECORATIONS 的關係",
    "檢查 flag 過濾的條件是否正確",
    "思考這個 bug 的安全影響"
  ],
  "bug_description": "Inverted condition causes SHOULD_SHOW_SYSTEM_DECORATIONS flag to be stripped from trusted displays instead of untrusted ones",
  "root_cause": "Condition `== 0` changed to `!= 0` in flag validation",
  "fix_complexity": "Change != 0 back to == 0",
  "created_at": "2025-01-25T09:00:00+08:00",
  "updated_at": "2026-02-19T21:15:00+08:00",
  "verified": true,
  "verification_date": "2026-02-21",
  "verification_result": "FAIL",
  "verification_notes": "Bug 導致 DisplayEventTest#testDisplayEvents 的 5 個測試失敗 ([#5: 2 true], [#6: 3 true], [#7: 10 true])。Bug 讓多顯示器的 events 被錯誤丟棄。",
  "verification_status": "complete",
  "verification_issues": [],
  "verification_device": "27161FDH20031X",
  "cts_summary": {
    "passed": 0,
    "failed": 2,
    "total": 2
  }
}