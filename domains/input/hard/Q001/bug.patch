diff --git a/frameworks/base/core/java/android/view/KeyEvent.java b/frameworks/base/core/java/android/view/KeyEvent.java
index abc1234..def5678 100644
--- a/frameworks/base/core/java/android/view/KeyEvent.java
+++ b/frameworks/base/core/java/android/view/KeyEvent.java
@@ -2999,12 +2999,12 @@ public class KeyEvent extends InputEvent implements Parcelable {
                     boolean handled = receiver.onKeyDown(code, this);
                     if (handled) {
                         mAction = ACTION_UP;
                         receiver.onKeyUp(code, this);
+                        mAction = ACTION_MULTIPLE;
+                        mRepeatCount = count;
                     }
-                    mAction = ACTION_MULTIPLE;
-                    mRepeatCount = count;
                     return handled;
                 }
                 return false;
         }
         return false;
