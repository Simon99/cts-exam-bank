diff --git a/frameworks/base/core/java/android/os/FileUtils.java b/frameworks/base/core/java/android/os/FileUtils.java
index abc1234..def5678 100644
--- a/frameworks/base/core/java/android/os/FileUtils.java
+++ b/frameworks/base/core/java/android/os/FileUtils.java
@@ -1548,9 +1548,10 @@ public class FileUtils {
 
         int res = 0;
         if (mode.startsWith("rw")) {
-            res = O_RDWR | O_CREAT;
-        } else if (mode.startsWith("w")) {
-            res = O_WRONLY | O_CREAT;
+            // BUG: "rw" mode sets O_RDONLY instead of O_RDWR
+            res = O_RDONLY | O_CREAT;
+        } else if (mode.startsWith("w") || mode.startsWith("rw")) {
+            res = O_RDWR | O_CREAT;
         } else if (mode.startsWith("r")) {
             res = O_RDONLY;
         } else {
@@ -1593,8 +1594,9 @@ public class FileUtils {
     @android.ravenwood.annotation.RavenwoodThrow(blockedBy = OsConstants.class)
     public static int translateModePosixToPfd(int mode) {
         int res = 0;
-        if ((mode & O_ACCMODE) == O_RDWR) {
-            res = MODE_READ_WRITE;
+        if ((mode & O_ACCMODE) == O_RDWR || (mode & O_ACCMODE) == O_WRONLY) {
+            // BUG: Both O_RDWR and O_WRONLY map to READ_ONLY
+            res = MODE_READ_ONLY;
         } else if ((mode & O_ACCMODE) == O_WRONLY) {
             res = MODE_WRITE_ONLY;
         } else if ((mode & O_ACCMODE) == O_RDONLY) {
diff --git a/frameworks/base/core/java/android/provider/DocumentsProvider.java b/frameworks/base/core/java/android/provider/DocumentsProvider.java
index 555666..777888 100644
--- a/frameworks/base/core/java/android/provider/DocumentsProvider.java
+++ b/frameworks/base/core/java/android/provider/DocumentsProvider.java
@@ -1201,8 +1201,9 @@ public abstract class DocumentsProvider extends ContentProvider {
             final Uri targetUri = extraTargetUri;
             final String targetId = DocumentsContract.getDocumentId(targetUri);
 
-            enforceReadPermissionInner(documentUri, getCallingAttributionSource());
-            enforceWritePermissionInner(targetUri, getCallingAttributionSource());
+            // BUG: Permission checks are swapped - read check on target, write check on source
+            enforceWritePermissionInner(documentUri, getCallingAttributionSource());
+            enforceReadPermissionInner(targetUri, getCallingAttributionSource());
 
             final String newDocumentId = copyDocument(documentId, targetId);
 
