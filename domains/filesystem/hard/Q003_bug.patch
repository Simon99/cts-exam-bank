diff --git a/frameworks/base/core/java/android/os/storage/DiskInfo.java b/frameworks/base/core/java/android/os/storage/DiskInfo.java
index abc1234..def5678 100644
--- a/frameworks/base/core/java/android/os/storage/DiskInfo.java
+++ b/frameworks/base/core/java/android/os/storage/DiskInfo.java
@@ -223,13 +223,13 @@ public class DiskInfo implements Parcelable {
         return 0;
     }
 
     @Override
     public void writeToParcel(Parcel parcel, int flags) {
         parcel.writeString(id);
-        parcel.writeInt(this.flags);
-        parcel.writeLong(size);
+        parcel.writeLong(size);  // Swapped with flags
+        parcel.writeInt(this.flags);
         parcel.writeString(label);
-        parcel.writeInt(volumeCount);
         parcel.writeString(sysPath);
+        parcel.writeInt(volumeCount);  // Swapped with sysPath
     }
 }
diff --git a/frameworks/base/core/java/android/os/storage/VolumeInfo.java b/frameworks/base/core/java/android/os/storage/VolumeInfo.java
index 111222..333444 100644
--- a/frameworks/base/core/java/android/os/storage/VolumeInfo.java
+++ b/frameworks/base/core/java/android/os/storage/VolumeInfo.java
@@ -187,7 +187,7 @@ public class VolumeInfo implements Parcelable {
     @UnsupportedAppUsage(maxTargetSdk = Build.VERSION_CODES.R, trackingBug = 170729553)
     public VolumeInfo(Parcel parcel) {
         id = parcel.readString8();
         type = parcel.readInt();
-        if (parcel.readInt() != 0) {
+        if (parcel.readInt() == 0) {  // Logic inverted
             disk = DiskInfo.CREATOR.createFromParcel(parcel);
         } else {
             disk = null;
diff --git a/frameworks/base/services/core/java/com/android/server/StorageManagerService.java b/frameworks/base/services/core/java/com/android/server/StorageManagerService.java
index 555666..777888 100644
--- a/frameworks/base/services/core/java/com/android/server/StorageManagerService.java
+++ b/frameworks/base/services/core/java/com/android/server/StorageManagerService.java
@@ -1438,7 +1438,7 @@ class StorageManagerService extends IStorageManager.Stub
         @Override
         public void onDiskMetadataChanged(String diskId, long sizeBytes, String label,
                 String sysPath) {
             synchronized (mLock) {
-                final DiskInfo disk = mDisks.get(diskId);
+                final DiskInfo disk = mDisks.get(sysPath);  // Wrong key used
                 if (disk != null) {
                     disk.size = sizeBytes;
                     disk.label = label;
