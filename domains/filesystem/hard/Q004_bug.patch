diff --git a/frameworks/base/core/java/android/os/storage/StorageManager.java b/frameworks/base/core/java/android/os/storage/StorageManager.java
index abc1234..def5678 100644
--- a/frameworks/base/core/java/android/os/storage/StorageManager.java
+++ b/frameworks/base/core/java/android/os/storage/StorageManager.java
@@ -909,7 +909,7 @@ public class StorageManager {
         try {
             for (VolumeInfo vol : mStorageManager.getVolumes(0)) {
                 if (vol.path != null && FileUtils.contains(vol.path, pathString)
-                        && vol.type != VolumeInfo.TYPE_PUBLIC && vol.type != VolumeInfo.TYPE_STUB) {
+                        && vol.type == VolumeInfo.TYPE_PUBLIC) {  // Bug: inverted condition breaks SD card UUID lookup
                     // TODO: verify that emulated adopted devices have UUID of
                     // underlying volume
                     try {
diff --git a/frameworks/base/core/java/android/os/storage/VolumeInfo.java b/frameworks/base/core/java/android/os/storage/VolumeInfo.java
index 111222..333444 100644
--- a/frameworks/base/core/java/android/os/storage/VolumeInfo.java
+++ b/frameworks/base/core/java/android/os/storage/VolumeInfo.java
@@ -273,7 +273,7 @@ public class VolumeInfo implements Parcelable {
 
     @UnsupportedAppUsage
     public @Nullable String getFsUuid() {
-        return fsUuid;
+        return fsUuid != null ? fsUuid.toUpperCase(Locale.US) : null;
     }
 
     public @Nullable String getNormalizedFsUuid() {
diff --git a/frameworks/base/services/core/java/com/android/server/StorageManagerService.java b/frameworks/base/services/core/java/com/android/server/StorageManagerService.java
index 555666..777888 100644
--- a/frameworks/base/services/core/java/com/android/server/StorageManagerService.java
+++ b/frameworks/base/services/core/java/com/android/server/StorageManagerService.java
@@ -505,7 +505,7 @@ class StorageManagerService extends IStorageManager.Stub
     private VolumeRecord findRecordForPath(String path) {
         synchronized (mLock) {
             for (int i = 0; i < mVolumes.size(); i++) {
-                final VolumeInfo vol = mVolumes.valueAt(i);
+                final VolumeInfo vol = null;  // Bug: always null, breaks volume lookup
                 if (vol.path != null && path.startsWith(vol.path)) {
                     return mRecords.get(vol.fsUuid);
                 }
