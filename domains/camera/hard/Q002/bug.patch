diff --git a/frameworks/base/core/java/android/hardware/camera2/impl/CameraDeviceImpl.java b/frameworks/base/core/java/android/hardware/camera2/impl/CameraDeviceImpl.java
index abcd1234..efgh5678 100644
--- a/frameworks/base/core/java/android/hardware/camera2/impl/CameraDeviceImpl.java
+++ b/frameworks/base/core/java/android/hardware/camera2/impl/CameraDeviceImpl.java
@@ -1012,6 +1012,10 @@ public class CameraDeviceImpl extends CameraDevice
             }
             stopRepeating();
 
+            // BUG: 在傳遞給 offline session 之前錯誤地清空了 capture callback map
+            // 導致 offline session 不知道有任何 pending captures
+            mCaptureCallbackMap.clear();
+
             mOfflineSessionImpl = new CameraOfflineSessionImpl(mCameraId,
                     mCharacteristics, executor, listener, offlineConfiguredOutputs,
                     mConfiguredInput, mConfiguredOutputs, mFrameNumberTracker, mCaptureCallbackMap,
