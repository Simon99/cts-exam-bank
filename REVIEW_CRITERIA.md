# CTS 題庫審查標準

**版本：** v1.0
**更新時間：** 2026-02-10

---

## 審查標準

### 1. 必備檔案完整性

每題必須有以下 4 個檔案：
- `Q###_question.md` — 題目描述（給候選人看）
- `Q###_answer.md` — 完整解答（評分用）
- `Q###_bug.patch` — 引入 bug 的 patch
- `Q###_meta.json` — 後設資料

### 2. 難度符合（依涉及檔案數）

| 難度 | 涉及檔案數 | 說明 |
|------|-----------|------|
| Easy | 1 | Bug 在單一檔案 |
| Medium | 2 | Bug 牽連 2 個檔案 |
| Hard | ≥3 | 錯誤邏輯橫跨 3 個以上檔案 |

### 3. Patch 可套用性

對照 `~/develop_claw/aosp-sandbox-1/`（AOSP android-14.0.0_r74）驗證：
- **行號正確** — 或 fuzz ≤3 行可接受
- **上下文匹配** — patch 的 context 行與實際源碼一致
- **引用存在** — 函數名、變數名、常量名都存在於目標檔案

### 4. 源碼比對驗證

必須實際比對 AOSP 源碼，確認 patch 的合適性：
- **AOSP 源碼**：`~/develop_claw/aosp-sandbox-1/` 對應檔案
- **CTS 源碼**：`~/cts/14_r7-linux_x86-arm/android-cts/` 相關測試
- 確認 patch 修改的位置、邏輯與實際源碼結構一致
- 不可僅依賴 `git apply --check`，需人工/AI 讀取源碼比對

---

## 審查流程

### Step 1：列出所有題目
掃描 `domains/` 目錄結構，建立題目清單。

### Step 2：檔案齊全檢查
每題檢查 4 個必備檔案是否存在。

### Step 3：難度符合檢查
讀取每題的 `bug.patch`，計算涉及檔案數，比對題目所在的難度資料夾。

### Step 4：Patch 驗證
對每個 patch 執行：
```bash
cd ~/develop_claw/aosp-sandbox-1/
git apply --check <patch_file>
```
或手動比對行號和上下文。

### Step 5：輸出報告
審查結果寫入 `REVIEW_REPORT.md`，格式：
- 按領域/難度分類
- 列出每題的審查結果（通過/問題）
- 統計通過率

---

## 審查結果分類

| 狀態 | 說明 |
|------|------|
| ✅ 通過 | 符合所有標準 |
| ⚠️ 小修 | 行號偏移可修復，邏輯正確 |
| ❌ 重寫 | 虛構代碼、結構不匹配、需重新設計 |

---

---

## 執行要求

### 1. 全量審查為預設
審查一律預設是**全量審查**。如果要抽查，需要事先討論確認：
- 如何抽樣
- 抽多少比例

### 2. Sub-agent 任務確認
使用 sub-agent 進行驗證前，必須：
- 先討論確認發給 sub-agent 的任務內容
- 確認後再啟動 sub-agent 執行

### 3. 一題一 Sub-agent
每一個 sub-agent 只負責**一題**的驗證，不可批量處理。

---

*審查標準 v1.0*
