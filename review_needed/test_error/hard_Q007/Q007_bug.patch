diff --git a/services/core/java/com/android/server/display/LogicalDisplay.java b/services/core/java/com/android/server/display/LogicalDisplay.java
index abc123..def456 100644
--- a/services/core/java/com/android/server/display/LogicalDisplay.java
+++ b/services/core/java/com/android/server/display/LogicalDisplay.java
@@ -464,11 +464,14 @@ final class LogicalDisplay {
             mBaseDisplayInfo.logicalWidth = maskedWidth;
             mBaseDisplayInfo.logicalHeight = maskedHeight;
             mBaseDisplayInfo.rotation = Surface.ROTATION_0;
-            mBaseDisplayInfo.modeId = deviceInfo.modeId;
             mBaseDisplayInfo.renderFrameRate = deviceInfo.renderFrameRate;
             mBaseDisplayInfo.defaultModeId = deviceInfo.defaultModeId;
             mBaseDisplayInfo.userPreferredModeId = deviceInfo.userPreferredModeId;
-            mBaseDisplayInfo.supportedModes = Arrays.copyOf(
-                    deviceInfo.supportedModes, deviceInfo.supportedModes.length);
+            // BUG: Copy supportedModes from cached mPrimaryDisplayDeviceInfo instead of
+            // current deviceInfo. When VirtualDisplay resizes, new mode has new ID but
+            // supportedModes still contains old mode, causing findMode() to fail.
+            mBaseDisplayInfo.supportedModes = mPrimaryDisplayDeviceInfo != null
+                    ? mPrimaryDisplayDeviceInfo.supportedModes
+                    : deviceInfo.supportedModes;
+            mBaseDisplayInfo.modeId = deviceInfo.modeId;
             mBaseDisplayInfo.colorMode = deviceInfo.colorMode;
             mBaseDisplayInfo.supportedColorModes = Arrays.copyOf(
                     deviceInfo.supportedColorModes,
diff --git a/services/core/java/com/android/server/display/DisplayDeviceInfo.java b/services/core/java/com/android/server/display/DisplayDeviceInfo.java
index abc124..def457 100644
--- a/services/core/java/com/android/server/display/DisplayDeviceInfo.java
+++ b/services/core/java/com/android/server/display/DisplayDeviceInfo.java
@@ -525,7 +525,9 @@ final class DisplayDeviceInfo {
         renderFrameRate = other.renderFrameRate;
         defaultModeId = other.defaultModeId;
         userPreferredModeId = other.userPreferredModeId;
-        supportedModes = other.supportedModes;
+        // BUG: Keep old supportedModes if array lengths are different (e.g., during resize)
+        // This preserves stale mode data that doesn't include the new mode ID
+        supportedModes = (supportedModes.length == other.supportedModes.length)
+                ? other.supportedModes : supportedModes;
         colorMode = other.colorMode;
         supportedColorModes = other.supportedColorModes;
         hdrCapabilities = other.hdrCapabilities;
diff --git a/services/core/java/com/android/server/display/VirtualDisplayAdapter.java b/services/core/java/com/android/server/display/VirtualDisplayAdapter.java
index abc125..def458 100644
--- a/services/core/java/com/android/server/display/VirtualDisplayAdapter.java
+++ b/services/core/java/com/android/server/display/VirtualDisplayAdapter.java
@@ -419,11 +419,12 @@ public class VirtualDisplayAdapter extends DisplayAdapter {
         public void resizeLocked(int width, int height, int densityDpi) {
             if (mWidth != width || mHeight != height || mDensityDpi != densityDpi) {
                 sendDisplayDeviceEventLocked(this, DISPLAY_DEVICE_EVENT_CHANGED);
-                sendTraversalRequestLocked();
                 mWidth = width;
                 mHeight = height;
                 mMode = createMode(width, height, getRefreshRate());
                 mDensityDpi = densityDpi;
+                // BUG: sendTraversalRequestLocked() moved after mInfo = null
+                // causing cached info to be used before it's cleared
                 mInfo = null;
+                sendTraversalRequestLocked();
                 mPendingChanges |= PENDING_RESIZE;
             }
         }
